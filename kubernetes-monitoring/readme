[root@otus kubernetes-monitoring]# helm install prom-stack prometheus-community/kube-prometheus-stack
NAME: prom-stack
LAST DEPLOYED: Sun Mar 30 07:30:01 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
kube-prometheus-stack has been installed. Check its status by running:
  kubectl --namespace default get pods -l "release=prom-stack"

Get Grafana 'admin' user password by running:

  kubectl --namespace default get secrets prom-stack-grafana -o jsonpath="{.data.admin-password}" | base64 -d ; echo

Access Grafana local instance:

  export POD_NAME=$(kubectl --namespace default get pod -l "app.kubernetes.io/name=grafana,app.kubernetes.io/instance=prom-stack" -oname)
  kubectl --namespace default port-forward $POD_NAME 3000

Visit https://github.com/prometheus-operator/kube-prometheus for instructions on how to create & configure Alertmanager and Prometheus instances using the Operator.


[root@otus kubernetes-monitoring]# kubectl apply -f configmap.yaml -f deployment.yaml -f service.yaml -f servicemonitor.yaml
configmap/nginx-config configured
deployment.apps/nginx configured
service/nginx configured
servicemonitor.monitoring.coreos.com/mon-nginx configured


[root@otus ~]# kubectl get -A svc
NAMESPACE       NAME                                                 TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                        AGE
default         alertmanager-operated                                ClusterIP   None             <none>        9093/TCP,9094/TCP,9094/UDP     27h
default         kubernetes                                           ClusterIP   10.96.0.1        <none>        443/TCP                        27h
default         prom-stack-grafana                                   ClusterIP   10.106.200.246   <none>        80/TCP                         27h
default         prom-stack-kube-prometheus-alertmanager              ClusterIP   10.111.21.31     <none>        9093/TCP,8080/TCP              27h
default         prom-stack-kube-prometheus-operator                  ClusterIP   10.99.35.175     <none>        443/TCP                        27h
default         prom-stack-kube-prometheus-prometheus                ClusterIP   10.109.121.35    <none>        9090/TCP,8080/TCP              27h
default         prom-stack-kube-state-metrics                        ClusterIP   10.107.55.223    <none>        8080/TCP                       27h
default         prom-stack-prometheus-node-exporter                  ClusterIP   10.110.235.80    <none>        9100/TCP                       27h
default         prometheus-operated                                  ClusterIP   None             <none>        9090/TCP                       27h
homework        nginx                                                ClusterIP   10.100.197.72    <none>        9113/TCP                       23m
ingress-nginx   ingress-nginx-controller                             NodePort    10.103.5.70      <none>        80:31077/TCP,443:30130/TCP     27h
ingress-nginx   ingress-nginx-controller-admission                   ClusterIP   10.96.142.36     <none>        443/TCP                        27h
kube-system     kube-dns                                             ClusterIP   10.96.0.10       <none>        53/UDP,53/TCP,9153/TCP         27h
kube-system     prom-stack-kube-prometheus-coredns                   ClusterIP   None             <none>        9153/TCP                       27h
kube-system     prom-stack-kube-prometheus-kube-controller-manager   ClusterIP   None             <none>        10257/TCP                      27h
kube-system     prom-stack-kube-prometheus-kube-etcd                 ClusterIP   None             <none>        2381/TCP                       27h
kube-system     prom-stack-kube-prometheus-kube-proxy                ClusterIP   None             <none>        10249/TCP                      27h
kube-system     prom-stack-kube-prometheus-kube-scheduler            ClusterIP   None             <none>        10259/TCP                      27h
kube-system     prom-stack-kube-prometheus-kubelet                   ClusterIP   None             <none>        10250/TCP,10255/TCP,4194/TCP   27h
[root@otus ~]# kubectl get -A endpoints
NAMESPACE       NAME                                                 ENDPOINTS                                                 AGE
default         alertmanager-operated                                10.244.0.36:9094,10.244.0.36:9094,10.244.0.36:9093        27h
default         kubernetes                                           192.168.49.2:8443                                         27h
default         prom-stack-grafana                                   10.244.0.37:3000                                          27h
default         prom-stack-kube-prometheus-alertmanager              10.244.0.36:8080,10.244.0.36:9093                         27h
default         prom-stack-kube-prometheus-operator                  10.244.0.34:10250                                         27h
default         prom-stack-kube-prometheus-prometheus                10.244.0.38:9090,10.244.0.38:8080                         27h
default         prom-stack-kube-state-metrics                        10.244.0.31:8080                                          27h
default         prom-stack-prometheus-node-exporter                  192.168.49.2:9100                                         27h
default         prometheus-operated                                  10.244.0.38:9090                                          27h
homework        nginx                                                10.244.0.41:9113                                          23m
ingress-nginx   ingress-nginx-controller                             10.244.0.33:443,10.244.0.33:80                            27h
ingress-nginx   ingress-nginx-controller-admission                   10.244.0.33:8443                                          27h
kube-system     k8s.io-minikube-hostpath                             <none>                                                    27h
kube-system     kube-dns                                             10.244.0.32:53,10.244.0.32:53,10.244.0.32:9153            27h
kube-system     prom-stack-kube-prometheus-coredns                   10.244.0.32:9153                                          27h
kube-system     prom-stack-kube-prometheus-kube-controller-manager   192.168.49.2:10257                                        27h
kube-system     prom-stack-kube-prometheus-kube-etcd                 192.168.49.2:2381                                         27h
kube-system     prom-stack-kube-prometheus-kube-proxy                192.168.49.2:10249                                        27h
kube-system     prom-stack-kube-prometheus-kube-scheduler            192.168.49.2:10259                                        27h
kube-system     prom-stack-kube-prometheus-kubelet                   192.168.49.2:10250,192.168.49.2:10255,192.168.49.2:4194   27h

![screenshot](Screenshot_3.png)
![screenshot](Screenshot_4.png)
